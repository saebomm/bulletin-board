<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout :: layout(~{::content})}">
<body>
<section th:fragment="content" class="bb-stack bb-stack--lg">

    <div class="bb-card bb-card--spaced bb-profile-container"
         th:with="
            statusLabels=${ {'ACTIVE':'활성','INACTIVE':'비활성','BLOCKED':'차단','WITHDRAW':'탈퇴'} },
            roleLabels=${ {'ADMIN':'관리자','USER':'일반 회원'} }
         ">

        <div class="bb-card__header">
            <div>
                <h1 class="bb-page-title">회원 정보 수정</h1>
                <p class="bb-page-subtitle">
                    관리자 권한으로 회원 정보를 수정할 수 있습니다.
                </p>
            </div>
        </div>

        <div class="bb-card__body">

            <form th:action="@{|/admin/members/${member.id}|}"
                  th:object="${adminMemberUpdateForm}"
                  method="post"
                  class="bb-form">

                <!-- 아이디 (수정 불가) -->
                <div class="bb-form-group">
                    <label class="bb-form-label">아이디</label>
                    <input type="text"
                           th:value="${member.username}"
                           class="bb-input"
                           disabled />
                </div>

                <!-- 이름 -->
                <div class="bb-form-group">
                    <label class="bb-form-label">이름</label>
                    <input type="text"
                           th:field="*{name}"
                           class="bb-input"/>

                    <div th:if="${#fields.hasErrors('name')}"
                         class="bb-field-error">
                        <span th:errors="*{name}"></span>
                    </div>
                </div>

                <!-- 이메일 -->
                <div class="bb-form-group">
                    <label class="bb-form-label">이메일</label>
                    <input type="text"
                           th:field="*{email}"
                           class="bb-input"/>

                    <div th:if="${#fields.hasErrors('email')}"
                         class="bb-field-error">
                        <span th:errors="*{email}"></span>
                    </div>
                </div>

                <!-- 권한 (enum 기반) -->
                <div class="bb-form-group">
                    <label class="bb-form-label">권한</label>
                    <select th:field="*{role}" class="bb-select">
                        <option th:each="r : ${roles}"
                                th:value="${r.name()}"
                                th:text="${roleLabels[r.name()]}">
                        </option>
                    </select>
                </div>

                <!-- 상태 (enum 기반) -->
                <div class="bb-form-group">
                    <label class="bb-form-label">상태</label>
                    <select th:field="*{status}" class="bb-select">
                        <option th:each="s : ${statuses}"
                                th:value="${s}"
                                th:text="${statusLabels[s.name()]}"
                                th:block th:if="${s.name() != 'WITHDRAW'}">
                        </option>
                    </select>

                    <p class="bb-form-hint">
                        * 탈퇴 상태는 회원 본인만 변경할 수 있습니다.
                    </p>
                </div>

                <!-- 마지막 수정일 -->
                <p class="bb-form-hint bb-form-hint--right"
                   th:if="${member.updatedAt != null}"
                   th:text="'마지막 수정일: ' + ${#temporals.format(member.updatedAt, 'yyyy.MM.dd HH:mm')}">
                </p>

                <div class="bb-actions bb-actions--right bb-profile-actions">
                    <a th:href="@{/admin/members}" class="bb-btn bb-btn--ghost">
                        취소
                    </a>
                    <button type="submit" class="bb-btn bb-btn--primary">
                        저장하기
                    </button>
                </div>

            </form>

        </div>
    </div>

</section>
</body>
</html>